<!DOCTYPE html>
<html lang="en" manifest="app.manifest">
<head>
<meta charset="UTF-8">
<title>Cache</title>
</head>
<body>
<div id="debugInfo"></div>
<script>
//开始检查
applicationCache.addEventListener('checking', function(e){
    console.log(['checking', e]);
});

applicationCache.addEventListener('progress', function(e){
    var loading = Math.round(e.loaded/e.total*100);
    parent.postMessage('loading:' + loading, '*');
    console.log(['progress', e]);
});

applicationCache.addEventListener('error', function(e){
    console.log(['error', e]);
    document.getElementById('debugInfo').innerHTML = '出错了！';
    parent.postMessage('出错了！', '*');
});

// 缓存完成
applicationCache.addEventListener('cached', function(e){
    document.getElementById('debugInfo').innerHTML = '缓存成功！';
    parent.postMessage('缓存成功！', '*');
});

// 无更新
applicationCache.addEventListener('noupdate', function(e){
    document.getElementById('debugInfo').innerHTML = '无更新！';
    parent.postMessage('无更新！', '*');
});

// 更新完成
applicationCache.addEventListener('updateready', function(e){
    document.getElementById('debugInfo').innerHTML = '更新完成！';
    parent.postMessage('更新完成！', '*');
});

// 废弃缓存
applicationCache.addEventListener('obsolete', function(e){
    document.getElementById('debugInfo').innerHTML = '离线缓存功能已删除！';
    parent.postMessage('离线缓存功能已删除！', '*');
});


</script>
</body>
</html>