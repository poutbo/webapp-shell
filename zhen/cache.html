<!DOCTYPE html>
<html lang="en" manifest="app.manifest">
<head>
<meta charset="UTF-8">
<title>Cache</title>
</head>
<body>
<script>
var state = true;
var app = 'http://doubi.io/zhen/app.html';
//开始检查
applicationCache.addEventListener('checking', function(e){
    console.log(['checking', e]);
});

// 无更新
applicationCache.addEventListener('noupdate', function(e){
    parent.postMessage('无更新！');
    parent.location.replace(app);
    state = false;
});

// 更新完成
applicationCache.addEventListener('cached', function(e){
    parent.postMessage('缓存成功！');
    parent.location.replace(app);
    state = false;
});

// 更新完成
applicationCache.addEventListener('updateready', function(e){
    parent.postMessage('更新完成！');
    parent.location.replace(app);
    state = false;
});

// 废弃缓存
applicationCache.addEventListener('obsolete', function(e){
    parent.postMessage('离线缓存功能已删除！');
    parent.location.replace(app);
    state = false;
});
</script>
</body>
</html>